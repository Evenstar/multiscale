H=[
    a(1,1) 0 a(1,3) a(2,1) 0 a(2,3) a(3,1) 0 a(3,3);
    0 a(1,2) 0 0 a(2,2) 0 0 a(3,2) 0;
    0 a(1,1) 0 0 a(2,1) 0 0 a(3,1) 0;
    a(1,2) 0 0 a(2,2) 0 0 a(3,2) 0 0;
    0 0 a(1,1) 0 0 a(2,1) 0 0 a(3,1);
    a(1,3) 0 0 a(2,2) 0 0 a(3,2) 0 0;
    0 0 a(1,2) 0 0 a(2,2) 0 0 a(3,2);
    0 a(1,3) 0 0 a(2,3) 0 0 a(3,3) 0;
]
f=[1 1 0 0 0 0 0 0]';
c=H\f;
c=reshape(c,[3,3])'
awbft_1d_err(x,fliplr(a),c,2)
%%
x=randn(1,100);
check_biframe_f(a,b,1)
awbft_1d_err(x,fliplr(a),b,2)

%%
x=randn(1,1000);
a=[ -0.1294    0.2241    0.8365    0.4830;
     -0.4830    0.8365   -0.2241   -0.1294];
a=orth(randn(4,4));
a=a(1:2,:);
% f=randn(1,4);
% a=[f(1) f(2) f(3) f(4);
% -f(4) f(3), f(2) f(1)];
H=[%a(1,1) 0 a(1,3) 0 a(2,1) 0 a(2,3) 0;
0 a(1,2) 0 a(1,4) 0 a(2,2) 0 a(2,4);
0 0 a(1,1) 0 0 0 a(2,1) 0 ;
a(1,3) 0 0 0 a(2,3) 0 0 0;
0 0 0 a(1,2) 0 0 0 a(2,2);
0 a(1,4) 0 0 0 a(2,4) 0 0;
0 a(1,1) 0 a(1,3) 0 a(2,1) 0  a(2,3);
a(1,2) 0 a(1,4) 0 a(2,2) 0 a(2,4) 0;
0 0 a(1,2) 0 0 0 a(2,2) 0;
a(1,3) 0 0 0 a(2,3) 0 0 0;
];
f=[1  0 0 0 0 0 0 0 0]';
c=H\f;
H*c
%%
c=reshape(c,[4,2])'
awbft_1d_err(x,fliplr(a),c,2)